meta {
  name: RequestProviderCredential
  type: http
  seq: 3
}

post {
  url: {{PROVIDER_IDHUB_ID_API}}/v1alpha/participants/{{B64_PROV_ID}}/credentials/request
  body: json
  auth: none
}

body:json {
  {
      "issuerDid": "{{ISS_ID}}",
      "credentials": [{
          "format": "VC1_0_JWT",
          "type": "MembershipCredential", 
          "id": "MC-Cred-Def"
      }]
  }
}

script:pre-request {
  const btoa = require("btoa");
  const prov_id = bru.getEnvVar("PROV_ID");
  bru.setEnvVar("B64_PROV_ID", btoa(prov_id));
  
  req.setHeader("x-api-key", bru.getEnvVar("PROVIDER_IH_APIKEY"));
}

settings {
  encodeUrl: true
  timeout: 0
}
